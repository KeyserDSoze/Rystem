@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.JSInterop
@inject IJSRuntime JSRuntime

@if (IsAuthenticated)
{
    @ChildContent
}
else
{
    <SocialLogin></SocialLogin>
}
@code {
    [Parameter]
    public required RenderFragment ChildContent { get; set; }
    private const string Key = "socialauth";
    private bool IsAuthenticated { get; set; }
    protected override Task OnParametersSetAsync()
    {
        return base.OnParametersSetAsync();
    }
    protected override Task OnInitializedAsync()
    {
        return base.OnInitializedAsync();
    }
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        var value = await GetItemAsync(Key);
        IsAuthenticated = value != null;
        await base.OnAfterRenderAsync(firstRender);
    }
    private async Task SetItemAsync(string key, string value)
    {
        await JSRuntime.InvokeVoidAsync("localStorageFunctions.setItem", key, value);
    }
    private async Task<string> GetItemAsync(string key)
    {
        return await JSRuntime.InvokeAsync<string>("localStorageFunctions.getItem", key);
    }
}
